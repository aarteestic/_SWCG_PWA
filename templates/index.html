<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shadow Wizard Coding Gang Website</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="icon" href="{{ url_for('static', filename='ASSETS/WBESITE_ICON.ico') }}">
</head>
<body>
  <div class="background-layer"></div>
  <nav>
    <div class="logo-container">
      <a href="/"> <!--calls the index page or 'default' URL-->
        <img src="{{ url_for('static', filename='ASSETS/NAV_IMG.png') }}" alt="Logo" class="navbar-logo">
      </a>
    </div>
    <button onclick="navigateTo(1)">Home</button>
    <button onclick="navigateTo(2)">Movies</button>
    <button onclick="navigateTo(3)">Users</button>
    <button class="invisible" disabled></button>
    <button class="invisible" disabled></button>
    <button class="invisible" disabled></button>
    {% if login: %}
    <button onclick="sendUserToTheirPage()">{{ sessionUsername }}</button>
    <form action="/" class="logoutForm" method="post">
      <button type="submit">Logout</button>
    </form>
    {% else: %}
    <button onclick="navigateTo(5)">Register</button>
    <button onclick="navigateTo(6)">Login</button>
    {% endif %}
  </nav>

  <div class="carousel-container">
    <button class="carousel-btn left" onclick="scrollCarousel('left')">←</button>
    <div class="carousel"></div>
    <button class="carousel-btn right" onclick="scrollCarousel('right')">→</button>
  </div>



  <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
  <script> // Carousel code placed within the index HTML
    function sendUserToTheirPage() {
      window.location.href = '/users/{{sessionUsername}}'
    }
    
    
    let numPosters = 3; // Set this value to control the number of movie posters
    let currentIndex = 0;

    const carousel = document.querySelector('.carousel');
    const container = document.querySelector('.carousel-container');




    function loadPosters() {
      carousel.innerHTML = '';
      const movieRecord = {{movie | tojson}}; //not actually movieRecord, but a list of all movies
      for (let i = 0; i < numPosters; i++) {
        const img = document.createElement('img');
        img.src = movieRecord[i][4];
        img.alt = `Poster ${i+1}`;
        carousel.appendChild(img);
        console.log('loaded ${i}')
      }
      updateCarouselPosition();
    }

    function scrollCarousel(direction) {
      const containerWidth = container.clientWidth;
      const posterWidth = carousel.querySelector('img').offsetWidth + 20;
      const totalPostersVisible = Math.floor(containerWidth / posterWidth);

      if (direction === 'left') {

        currentIndex = Math.max(currentIndex - 1, 0);
      } else if (direction === 'right') {

        currentIndex = Math.min(currentIndex + 1, numPosters - totalPostersVisible);
      }

      updateCarouselPosition();
    }

    function updateCarouselPosition() {
      const posterWidth = carousel.querySelector('img').offsetWidth + 20;
      carousel.style.transform = `translateX(-${currentIndex * posterWidth}px)`;
    }

    window.onload = () => {
      loadPosters();
    };
  </script>
</body>
</html>
